# Road-damage-segmentation

<h2>Введение</h2>

В данном проекте решена задача сегментация повреждений дорожного покрытия. Для этого использовались свёрточные нейросети. 
Также реализован алгоритм опредления размера повреждения.


<h2>Набор данных</h2>
 

Для обучения и тестирования разрабатываемого алгоритма собран
набор данных, представляющий собой размеченные вручную кадры с записи с видеорегистратора поездки по дорогам
Новосибирска, форматом 3840 на 2160 ppx. В наборе представлены различные дорожные ситуации: движение по трассе или городской дороге, виды
ограждений, обочин и разметки на проезжей части, наличие или отсутствие проезжающего транспорта разных габаритов, погодные условия, степень
разрушения дорожного покрытия. Набор изображений разделенна две части. В первой части разметка производилась на два класса, дорога и не
дорога. Во второй — повреждение и фон.

<p>
  <img src="https://github.com/Alinasas/Road-damage-segmentation/blob/master/readme_images/l_img11241.png" width="315" height="177" title="road">
  <img src="https://github.com/Alinasas/Road-damage-segmentation/blob/master/readme_images/l_road_mask_img11241.png" width="315" height="177" title="road_mask">
  <img src="https://github.com/Alinasas/Road-damage-segmentation/blob/master/readme_images/l_defect_mask_img11241.png" width="315" height="177" title="efect_mask">
</p>

Для улучшения качества работы моделей реализована аугментация. Исходное изображение зеркально отражалось повертикали и к нему с вероятностью 0.8 применялись цветовые преобразования:гамма-коррекция, изменение значений по цветовым каналам RGB (изменение происходит с вероятностью 0.5), а также яркость, контрастность
и насыщенность.

<h3>Картинки</h3>

<h2>Инструменты</h2>

<ul>
  <li>Data_Preprocessor</li>
  Класс Preprocessor Используется для преобразования иходных изображений в подходящий для нейросети вид. Изображения обезаются, уменьшаются и сохраняются в формате .png и .npy(преобразование в np.array и сохранение на этом этапе позволяет избежать этого на последующих этапах, что ускоряет обучение сетей). Также моно преобразовать видео. 
  Также включён модуль Augmentator для аугментации данных.
  <li>Data_Generator</li>
  Используется для подачи данных нейросети небольшим пакетами для того, чтобы не загружать ОП.
  <li>Callbacks_lib</li>
  Используется для вычисления и сохранения значения метрик(IoU,Precision, Recall, Dice index, Pixel Accuracy)
  в конце каждой эпохи на обучающей и валидационной выборках.
  <li>Road_models</li>
  Класс Unet_model для создания и обучения модели UNET для сегментации дорожного покрытия.
  Класс DeeplabV3_mv2_model vдля создания и обучения модели Deeplab v3 с энкодером mobilenet v2 для сегментации дорожного покрытия.
  <li>Defect_models</li>
  Класс для создания и обучения модели UNET для сегментации повреждений дорожного покрытия.
  <li>Evaluate_and_Inference</li>
  Класс визуализации работы модели. Позволяет получить предсказания,
  получить метрики качества для любой из подзадач - сегменации дорожного покрытия или повреждений на нём,
  при чём может быть использованно любое число моделей с любой степенью важности каждой. Метрики рассчитыватся
  как для отдельного изображения, так и средние значения для всего набора,
  строятся графики изменения метрик на оучающей и валидационной выборке.
  Также можно создать видео, отображающее предсказания модели.
  Для отдельного изображения можно получить карту активации.
  <li>Defect_area</li>
  Класс опредления площади повреждения дорожного покрытия.
</ul>
  

